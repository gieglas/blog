<!doctype html>
<html lang="en">
    <head>
    <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Social -->
        <meta property="og:description" content="A guide on through how I turned my last app into a PWA.">
        <meta property="og:title" content="How I made my app a PWA - Con&#39;s place">
        <meta property="og:url" content="https://gieglas.github.io/blog/">
        <meta property="og:type" content="website">
        <meta property="og:image" content="/blog/img/Code-PWA.png">
        <meta property="og:site_name" content="Con&#39;s place">
    
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://gieglas.github.io/blog/">
        <meta property="twitter:title" content="How I made my app a PWA - Con&#39;s place">
        <meta property="twitter:description" content="A guide on through how I turned my last app into a PWA.">
        <meta property="twitter:image" content="/blog/img/Code-PWA.png">
        <!-- Theme --> 
        <link rel="manifest" href="/blog/manifest.json">
        <meta name="theme-color" content="#0090d3">
        <link rel="icon" type="image/png" sizes="48x48" href="/blog/img/favicon-48x48.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/blog/img/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/blog/img/favicon-16x16.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/img/apple-touch-icon-144x144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/blog/img/apple-touch-icon-120x120-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/img/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/img/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="/blog/img/apple-touch-icon-57x57-precomposed.png">
        <!-- Bootstrap CSS -->
        <link href="/blog/css/main.css" rel="stylesheet" >
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic"/>
        <link href="/blog/css/docs.css" rel="stylesheet" >
        <!-- Prism Highlighter CSS -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css" rel="stylesheet">
        <title>How I made my app a PWA - Con&#39;s place</title>
        <meta name="description" content="A guide on through how I turned my last app into a PWA.">
        <meta name="author" content="Constantinos Evangelou">
    </head>
    <body>
        <!-- Skip link -->
        <a href="#mainContainer" class="govcy-skip-link govcy-mb-0">Skip to main content</a> 
        <!--Header-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Shadows+Into+Light+Two&display=swap" rel="stylesheet">
    <header class="govcy-container-fluid govcy-p-0 govcy-pt-2 govcy-m-0 govcy-position-relative govcy-d-print-none ce-header">
         <div class="govcy-container">
             <div class="row">
                <!--Displayed only on desktop-->
                <div class="d-none d-md-block govcy-p-0 govcy-m-0 ">
                    <a href="/blog/" class="desktop-header personal-logo">
                        <img aria-hidden="true" alt="Con&#39;s place logo" src="/blog/img/GieglasIconInverse.png">
                        Con&#39;s place
                    </a>
                </div>
                <!-- Diplay only on desktop end -->
                <span class="d-none d-md-block tagline govcy-mb-0 govcy-mt-1 govcy-ml-1">Be creative </span>
                <div class="govcy-header govcy-mb-0">
                    <nav class="navbar navbar-expand-md navbar-light">
                        <div class="govcy-container govcy-p-0 govcy-m-0 govcy-mr-2">
                            <!--Displayed only on mobile-->
                            <div class="d-md-none"><a href="/blog/" class="mobile-header personal-logo"><img alt="Con&#39;s place" src="/blog/img/GieglasIconInverse.png">Con&#39;s place</a></div>
                            <!-- Displayed only on mobile end -->
                            <!-- Displayed only on mobile button-->                            
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                <span>
                                    <span style="vertical-align: middle !important;" class="govcy-mr-1 material-icons">menu</span>Menu 
                                </span>
                            </button>
                            <!-- Displayed only on mobile end -->
                            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                                <ul class="navbar-nav me-auto mb-2 mb-md-0 govcy-ml-3">
                                    <li class="nav-item">
                                    <a href="/blog/"  class="nav-link" >
                                        Home
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/blog/"  class="nav-link active" aria-current="page" >
                                        Blog
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/about/"  class="nav-link" >
                                        About
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/search/"  class="nav-link" >
                                        Search
                                    </a>
                                    </li></ul>
                                
                                
                                
                                
                            </div>
                        </div>
                    </nav>
                    <!--Displayed only on mobile-->
                    <span class="d-md-none tagline govcy-mb-0 govcy-ml-3">Be creative </span>
                    <!-- Displayed only on mobile  end -->
                </div>
             </div>
         </div>
    </header>
    
        <!--Main-->
        <main class="govcy-container govcy-my-4" id="mainContainer">
            <div class="row">
                <div class="govcy-col-8 govcy-order-last">
                    <h1>How I made my app a PWA</h1>
                    <p class="post-date">Posted on 
                                      <time datetime="2019-07-29T00:00:00.000Z">29 July 2019</time> 
                                      • Tagged with 
                                      
                                            <a class="post-tag" href="/blog/tags/dev">dev</a>
                                        
                                            <a class="post-tag" href="/blog/tags/pwa">pwa</a>
                                        </p>
                    
                     
                    <img aria-hidden="true" src="/blog/img/Code-PWA.png" alt="Graphic for How I made my app a PWA" class="img-fluid pop-small govcy-mb-4"></a>
                    
                    <p>I have <a href="../why-i-made-my-app-a-pwa/">previously posted on why</a> I made my <a href="../intellectual-and-industrial-property-eservices/">app</a> a Progressive Web App (or simply <a href="https://developers.google.com/web/progressive-web-apps/" target="_blank">PWA</a> ) and in this post I will try and explain <em>how</em> I turned my app into a PWA.</p>
<p>Note that the code I am presenting in this post is just a sample. It is for educational purposes and will definitely not work if you simply copy and paste it. I just want to present some ideas around service workers and to show how easy it is to create a PWA and serve offline content. For other aspects of how I made the app check out <a href="../online-search-registry-cregistry/">Online search registry (cRegistry)</a>.</p>
<p>In my post I will focus on the 3 mandatory steps which are:</p>
<ol>
<li>add a <strong><a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank">service worker</a></strong></li>
<li>add a <strong><a href="https://developers.google.com/web/fundamentals/web-app-manifest/" target="_blank">manifest</a></strong> file</li>
<li>use <strong>https</strong></li>
</ol>
<h3>1. Service Worker</h3>
<p>As I mentioned in my previous post, the most important thing to transform your app into a PWA is the service worker.</p>
<h4>App.js</h4>
<p>The service worker is independent of the web page so the code must be on a separate file. There has to be a way though to connect your app with the service worker and that is better done while loading the page. In my code below I use the <code>jQuery on load</code> function to register the service worker. I also added an <code>EventListener</code>, to listen for messages from the service worker. In my example I simply get a message from the service worker that the user is offline so I can display an alert.</p>
<pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'load'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <br><span class="token comment">// ... </span><br><span class="token function">registerSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token keyword">function</span> <span class="token function">registerSW</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'serviceWorker'</span> <span class="token keyword">in</span> navigator<span class="token punctuation">)</span> <span class="token punctuation">{</span> <br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>        <span class="token comment">//register listener for messages</span><br>        navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token comment">//If message is offline        </span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token string">"Offline"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token comment">//custom function to show offline alert</span><br>                <span class="token function">showGenericAlert</span><span class="token punctuation">(</span><span class="token string">"Offline"</span><span class="token punctuation">,</span><span class="token string">"You are currently not connected to the internet. You can still use the site, but if you wish to use search service, you will need to reconnect to the internet."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>data <span class="token operator">==</span> <span class="token string">"Online"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token comment">//custom function to hide offline alert</span><br>                <span class="token function">hideGenericAlert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">//register service worker code</span><br>        navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'./sw.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <br>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'ServiceWorker registration failed. Sorry about that.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>One note about the location of the service worker file. The service worker file (<code>sw.js</code> in this case) is located in the root of the domain as it defines it’s scope, meaning it will receive <code>fetch</code> events for everything on this domain.</p>
<h4>sw.js</h4>
<p>In my service worker I used a very simplistic approach for caching. I simply have a list of content that I wish to cache, add them to the cache on install and then serve that content on fetch. To break it down, I have added the following event listeners on the service worker (check out this <a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank">introduction on service worker</a> for more information on the life cycle):</p>
<p><strong>Install</strong></p>
<p>During the install event, all the content that is defined in the “<code>staticAssets</code>” array are added to the cache with name “<code>cacheName</code>“.</p>
<p>Note that in order to force the browser to renew the cache, say in case we changed some static content, I would have to change the “<code>cacheName</code>“.</p>
<p><strong>Activate</strong></p>
<p>During the activate event, if the “<code>cacheName</code>” has changed, the old cache is deleted from the user’s browser.</p>
<p><strong>Fetch</strong></p>
<p>All the magic is done in the fetch event. The event will be fired whenever a resource is requested by the client and by calling call the <code>respondWith()</code> method, we get to change the HTTP response and update it with whatever you want. In our case, we want to enforce a cacheFirst policy, where we return a resource from the cache if found, else allow the fetch from the network. Also in the fetch event, I sent the message to the page (mentioned above) that the user is offline or online.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> cacheName <span class="token operator">=</span> <span class="token string">'pwa-conf-v6'</span><span class="token punctuation">;</span><br><span class="token keyword">const</span> offlineUrl <span class="token operator">=</span> <span class="token string">'tmpl/offline/scripts.js'</span><span class="token punctuation">;</span><br><span class="token comment">// add static assets to be precached</span><br><span class="token keyword">const</span> staticAssets <span class="token operator">=</span> <span class="token punctuation">[</span><br>  <span class="token string">'.'</span><span class="token punctuation">,</span><br>  <span class="token string">'favicon.ico'</span><span class="token punctuation">,</span><br>  <span class="token string">'index.html'</span><span class="token punctuation">,</span><br>  <span class="token string">'manifest.json'</span><span class="token punctuation">,</span><br>  <span class="token comment">//JS</span><br>  <span class="token string">'js/app.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/bootstrap.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/bootstrap.min.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/jquery-3.2.1.min.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/loading.gif'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/loadingoverlay.min.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/parsley.min.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'js/sammy.js'</span><span class="token punctuation">,</span><br>  <span class="token comment">//css</span><br>  <span class="token string">'css/style.css'</span><span class="token punctuation">,</span><br>  <span class="token string">'css/bootstrap.min.css'</span><span class="token punctuation">,</span><br>  <span class="token comment">//fonts</span><br>  <span class="token string">'fonts/glyphicons-halflings-regular.woff2'</span><span class="token punctuation">,</span><br>  <span class="token comment">//imgages</span><br>  <span class="token string">'img/DRCOR.jpg'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-72x72.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-96x96.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-128x128.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-144x144.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-152x152.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-192x192.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-384x384.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/icon-512x512.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/loading.gif'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/responsive.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/thyreos.gif'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/design.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/newspaper.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/patent.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/publication.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/trademark.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/file.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/pdf-file-format-symbol.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/pdf-file-format-symbol_24.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/file_24.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/application_24.png'</span><span class="token punctuation">,</span><br>  <span class="token string">'img/upload_24.png'</span><span class="token punctuation">,</span><br>  <span class="token comment">//templates</span><br>  <span class="token string">'tmpl/headfoot.html'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/local.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/home/content.html'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/home/local.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/home/scripts.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/trademark/local.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/trademark/content.html'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/trademark/scripts.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/publications/local.js'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/publications/content.html'</span><span class="token punctuation">,</span><br>  <span class="token string">'tmpl/publications/scripts.js'</span><span class="token punctuation">,</span><br><span class="token punctuation">]</span><span class="token punctuation">;</span><br> <br><span class="token comment">//install event</span><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'install'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">;</span> <br>    <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>staticAssets<span class="token punctuation">)</span><span class="token punctuation">;</span> <br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token comment">//activate event</span><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'activate'</span><span class="token punctuation">,</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token comment">// delete any caches that aren't in expectedCaches</span><br>  <span class="token comment">// which will get rid of old cache version</span><br>  event<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span><br>    caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">keys</span> <span class="token operator">=></span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><br>      keys<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>cacheName<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><br>    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"new version now ready to handle fetches!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token comment">//fetch event</span><br>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">event</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>  <span class="token keyword">const</span> req <span class="token operator">=</span> event<span class="token punctuation">.</span>request<span class="token punctuation">;</span><br>  event<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span><span class="token function">cacheFirst</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <br><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br> <br><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">cacheFirst</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>isOffline</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">;</span> <br>  <span class="token comment">//used this to use ignoreSearch only on urls that have ? on url (because that makes everything slower)</span><br>  <span class="token keyword">var</span> hasQuery <span class="token operator">=</span> req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"scripts.js?"</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span><br>    <span class="token keyword">const</span> cachedResponse <span class="token operator">=</span> <span class="token keyword">await</span> cache<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span><span class="token punctuation">{</span><br>        <span class="token comment">// ignore query section of the URL based on our variable</span><br>        <span class="token literal-property property">ignoreSearch</span><span class="token operator">:</span> hasQuery<span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>   <br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isOffline<span class="token punctuation">)</span><span class="token punctuation">{</span><br>    self<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">all</span> <span class="token operator">=></span> all<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">client</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        client<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">"Offline"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>    self<span class="token punctuation">.</span>clients<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">all</span> <span class="token operator">=></span> all<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">client</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        client<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token string">"Online"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br> <br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedResponse <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Undefined:"</span><span class="token punctuation">,</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><br>    <span class="token keyword">return</span> cachedResponse <span class="token operator">||</span> <span class="token function">fetch</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span> <br><span class="token punctuation">}</span></code></pre>
<h3>2. Manifest</h3>
<p>The manifest.json is a simple json file that simply explains to the browser how to install the app on the users’ device. It’s pretty much self explanatory, but do check out the <a href="https://developer.mozilla.org/en-US/docs/Web/Manifest" target="_blank">documentation</a> for more information.</p>
<pre class="language-js"><code class="language-js"><span class="token punctuation">{</span><br>  <span class="token string-property property">"name"</span><span class="token operator">:</span> <span class="token string">"DRCOR IP eServices"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"short_name"</span><span class="token operator">:</span> <span class="token string">"IP eServices"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"start_url"</span><span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"background_color"</span><span class="token operator">:</span> <span class="token string">"#E05830"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"description"</span><span class="token operator">:</span> <span class="token string">"Electronic Services of the Department of Registrar of Companies, Intellectual and Industrial Property Section"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#E05830"</span><span class="token punctuation">,</span><br>  <span class="token string-property property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-72x72.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"72x72"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-96x96.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"96x96"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-128x128.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"128x128"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-192x192.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-384x384.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"384x384"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span><br>      <span class="token string-property property">"src"</span><span class="token operator">:</span> <span class="token string">"img/icon-512x512.png"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"sizes"</span><span class="token operator">:</span> <span class="token string">"512x512"</span><span class="token punctuation">,</span><br>      <span class="token string-property property">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">]</span><br><span class="token punctuation">}</span></code></pre>
<h3>3. HTTPS</h3>
<p>There is no code involved in this step, other than making sure that all references to javascript files, image files, links and so on, are all in HTTPS. If just one of your references is not secure, then Chrome for example will not recognise your app as a PWA and will not show the message to your users to install the app. Check out <a href="https://www.whynopadlock.com/" target="_blank">Why not padlock</a> tool which gives you a nice analysis of your site’s security in respect to SSL and mixed content.</p>
<h3>Summary</h3>
<p>The amount of effort involved to turn a Javascript App, or even any web site, into a PWA is not that big. The only challenge is understanding all the concepts that are used, especially when it comes to the service worker. I just hope my post helped shed some light this service worker concepts.</p>

                </div>
            </div>
        </main>
        <!-- Footer -->
            <footer class="govcy-container-fluid govcy-p-3 govcy-pl-0 govcy-d-print-none">
        <div class="govcy-container">
            <div class="row">   
                <div class="govcy-footer">
                        <ul class="govcy-d-inline-block govcy-m-0  govcy-pl-0 govcy-efs-medium">
                            <li><a href="/privacy-statement/">Privacy</a></li>
                            <li><a href="/cookie-policy/">Cookies</a></li>
                            <li><a href="/accessibility-statement/">Accessibility</a></li>
                            <li class="govcy-d-block govcy-text-dark">© Constantinos Evangelou, 2024</li>
                        </ul>
                </div>
            </div>
        </div>
    </footer>
        <!-- js stuff -->
                <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
        
        </script>       
    </body>
</html>