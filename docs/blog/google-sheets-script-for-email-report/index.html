<!doctype html>
<html lang="en">
    <head>
    <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Social -->
        <meta property="og:description" content="Design your services using gov.cy styles, components and patterns.">
        <meta property="og:title" content="Google Sheets Script for email report - Con&#39;s place">
        <meta property="og:url" content="https://gov-cy.github.io/govcy-design-system-docs/">
        <meta property="og:type" content="website">
        <meta property="og:image" content="/img/GoogleSheetEmail.png">
        <meta property="og:site_name" content="Con&#39;s place">
    
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://gov-cy.github.io/govcy-design-system-docs/">
        <meta property="twitter:title" content="Google Sheets Script for email report - Con&#39;s place">
        <meta property="twitter:description" content="Design your services using gov.cy styles, components and patterns.">
        <meta property="twitter:image" content="/img/GoogleSheetEmail.png">
        <!-- Theme --> 
        <link rel="manifest" href="/blog/manifest.json">
        <meta name="theme-color" content="#0090d3">
        <link rel="icon" type="image/png" sizes="48x48" href="/blog/img/favicon-48x48.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/blog/img/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/blog/img/favicon-16x16.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/img/apple-touch-icon-144x144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/blog/img/apple-touch-icon-120x120-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/img/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/img/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="/blog/img/apple-touch-icon-57x57-precomposed.png">
        <!-- Bootstrap CSS -->
        <link href="/blog/css/main.css" rel="stylesheet" >
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic"/>
        <link href="/blog/css/docs.css" rel="stylesheet" >
        <!-- Prism Highlighter CSS -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css" rel="stylesheet">
        <title>Google Sheets Script for email report - Con&#39;s place</title>
        <meta name="description" content="Design your services using gov.cy styles, components and patterns.">
    </head>
    <body>
        <!-- Skip link -->
        <a href="#mainContainer" class="govcy-skip-link govcy-mb-0">Skip to main content</a> 
        <!--Header-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Shadows+Into+Light+Two&display=swap" rel="stylesheet">
    <header class="govcy-container-fluid govcy-p-0 govcy-pt-2 govcy-m-0 govcy-position-relative govcy-d-print-none ce-header">
         <div class="govcy-container">
             <div class="row">
                <!--Displayed only on desktop-->
                <div class="d-none d-md-block govcy-p-0 govcy-m-0 ">
                    <a href="/blog/" class="desktop-header personal-logo">
                        <img alt="Con&#39;s place logo" src="/blog/img/GieglasIconInverse.png">
                        Con&#39;s place
                    </a>
                </div>
                <!-- Diplay only on desktop end -->
                <span class="d-none d-md-block tagline govcy-mb-0 govcy-mt-1 govcy-ml-1">Be creative </span>
                <div class="govcy-header govcy-mb-0">
                    <nav class="navbar navbar-expand-md navbar-light">
                        <div class="govcy-container govcy-p-0 govcy-m-0 govcy-mr-2">
                            <!--Displayed only on mobile-->
                            <div class="d-md-none"><a href="/blog/" class="mobile-header personal-logo"><img alt="Con&#39;s place" src="/blog/img/GieglasIconInverse.png">Con&#39;s place</a></div>
                            <!-- Displayed only on mobile end -->
                            <!-- Displayed only on mobile button-->                            
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                <span>
                                    <span style="vertical-align: middle !important;" class="govcy-mr-1 material-icons">menu</span>Menu 
                                </span>
                            </button>
                            <!-- Displayed only on mobile end -->
                            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                                <ul class="navbar-nav me-auto mb-2 mb-md-0 govcy-ml-3">
                                    <li class="nav-item">
                                    <a href="/blog/"  class="nav-link" >
                                        Home
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/blog/"  class="nav-link active" aria-current="page" >
                                        Blog
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/contact/"  class="nav-link" >
                                        Contact
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/search/"  class="nav-link" >
                                        Search
                                    </a>
                                    </li></ul>
                                
                                
                                
                                
                            </div>
                        </div>
                    </nav>
                    <!--Displayed only on mobile-->
                    <span class="d-md-none tagline govcy-mb-0 govcy-ml-3">Be creative </span>
                    <!-- Displayed only on mobile  end -->
                </div>
             </div>
         </div>
    </header>
    
        <!--Main-->
        <main class="govcy-container govcy-my-4" id="mainContainer">
            <div class="row">
                <div class="govcy-col-8 govcy-order-last">
                    <h1>Google Sheets Script for email report</h1>
                    <p class="govcy-hint">26 August 2018 </p>
                    
                     
                    <img src="/img/GoogleSheetEmail.png" alt="Google Sheets Script for email report" class="img-fluid pop-small govcy-mb-4"></a>
                    
                    <p>After working a little bit with Google Sheets and seeing it’s power in action, we thought it would be nice to automate email reports / notifications or even reminders. So once again I tried to make a general purpose script that we could reuse whenever we need to send the contents of a specific sheet. When combining the script, with Google Spreadsheet build in functions and event triggers (in my case Time Driven triggers), you can pretty much automate any kind of report you like.</p>
<p>An example of this type of automation is related to my previous post <a href="../google-sheets-script-for-trello/">Google Sheets script for Trello</a>, where we import data from Trello Boards and apply different filters on separate sheets. Using the script and a weekly event trigger, we have a weekly summary email automatically sent for the TODO and DOING tasks.</p>
<h2>Approach</h2>
<p>I wrote a script for my Google Sheet using Google Apps Script, to send emails based on the options defined on a specific sheet (See screenshoot below).</p>
<p><img src="../../img/GoogleSheetEmailOptions-1.png" alt="Email sheet screenshot" class="img-fluid pop-small govcy-mb-3"></p>
<p>The “Email Options” sheet, must have the following values in row 6.</p>
<ol>
<li><strong>name</strong>: The name of the sheet (per sheet)</li>
<li><strong>title</strong>: The Title of the sheet to be displayed in the email (per sheet)</li>
<li><strong>headersAtRow</strong>: Where is the header row located in the sheet. The header will contain the titles of the columns and the next row will contain the data (Row 1 is 0) (per sheet)</li>
<li><strong>display</strong>: The display format of the content in the email. Can be 1 of the following formats: table, list,numbered,lines, title (Not linked to a sheet Data), paragraph (Not linked to a sheet Data)</li>
<li><strong>columnsToSend</strong>: Which columns to include in the contents of the email, separated by comma. (Column A is 0). Example 0,1,2 (per sheet)</li>
<li><strong>Current Date</strong>: The current date (No need to change this)</li>
<li><strong>Emails addresses</strong>: Email addresses to send the notifications. Separate emails with a comma</li>
<li><strong>Message Prefix</strong>: The notification message header (in HTML Format)</li>
<li><strong>Message PostFix</strong>: The notification email footer (in HTML Format)</li>
<li><strong>Subject</strong>: The subject of the email</li>
</ol>
<p>The first 5 columns concern Information about which sheets to send the email and what content. Can have more that 1 row for each sheet to send. 1 row for each sheet.</p>
<p>Then there is an empty column</p>
<p>The next 5 columns concern Information about the notification email header. Only 1 row of options is valid</p>
<p>The script went something like this:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token comment">//default values</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>emailOptionsSheet <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> emailOptionsSheet<span class="token operator">=</span><span class="token string">"Email Options"</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> enableStackdriverLogging<span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>logingName <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> logingName <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>     <br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - emailSheetContent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - emailSheetContent STARTED"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token keyword">var</span> sheetsToEmail <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">// get active spreadsheet</span><br>    <span class="token keyword">var</span> ss <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> sheetUrl <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">//get Options start---------------------------</span><br>    <span class="token keyword">var</span> sOptions2<span class="token operator">=</span>ss<span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>emailOptionsSheet<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> sOptions2range <span class="token operator">=</span> sOptions2<span class="token punctuation">.</span><span class="token function">getDataRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> sOptions2values <span class="token operator">=</span> sOptions2range<span class="token punctuation">.</span><span class="token function">getDisplayValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> sOptions2lastRow <span class="token operator">=</span> sOptions2range<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">//for each row in body options sheet</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> f <span class="token operator">&lt;</span> sOptions2lastRow<span class="token punctuation">;</span> f<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span><br>      sheetsToEmail<span class="token punctuation">[</span>f<span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">""</span> <span class="token operator">+</span> sOptions2values<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> sOptions2values<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">headersAtRow</span> <span class="token operator">:</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>sOptions2values<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token literal-property property">display</span><span class="token operator">:</span> sOptions2values<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">columnsToSend</span><span class="token operator">:</span> sOptions2values<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">;</span>      <br>    <span class="token punctuation">}</span>    <br>     <br>    <span class="token comment">//get header options    </span><br>    <span class="token keyword">var</span> email <span class="token operator">=</span> sOptions2values<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <br>    <span class="token keyword">var</span> messagePreFix <span class="token operator">=</span> sOptions2values<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> messagePostFix <span class="token operator">=</span> sOptions2values<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;br />"</span> <span class="token operator">+</span> ss<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> messageSubject <span class="token operator">=</span> sOptions2values<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> message <span class="token operator">=</span> messagePreFix <span class="token operator">+</span> <span class="token string">"&lt;br /> "</span><span class="token punctuation">;</span><br>    <span class="token comment">//get Options end---------------------------</span><br>     <br>    <span class="token comment">//write message start ----------------------</span><br>    <span class="token comment">// fop each Sheet defined in body options</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> h<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> h<span class="token operator">&lt;</span>sheetsToEmail<span class="token punctuation">.</span>length<span class="token punctuation">;</span> h<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token comment">// Start message with header with the title of each sheet ---- MESSAGE ---</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"title"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message  <span class="token operator">+</span> <span class="token string">"&lt;h2>"</span> <span class="token operator">+</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">"&lt;/h2>"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"paragraph"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message <span class="token operator">+</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message  <span class="token operator">+</span> <span class="token string">"&lt;h3>"</span> <span class="token operator">+</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">"&lt;/h3>"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token comment">//---------------</span><br>       <br>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">!=</span> <span class="token string">"title"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">!=</span> <span class="token string">"paragraph"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token comment">//Get sheet </span><br>        <span class="token keyword">var</span> sheet <span class="token operator">=</span> ss<span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> range <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getDataRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> values <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getDisplayValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <br>        <span class="token keyword">var</span> lastRow <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>         <br>        <span class="token comment">//begin table, list, numbered ---- MESSAGE ---</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;table>&lt;tr>"</span><span class="token punctuation">;</span><br>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> g <span class="token operator">&lt;</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">.</span>length<span class="token punctuation">;</span> g<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;td>&lt;b>"</span> <span class="token operator">+</span>values<span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>headersAtRow<span class="token punctuation">]</span><span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">[</span>g<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/b>&lt;/td>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>          message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/tr>"</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;ul>"</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"numbered"</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;ol>"</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><span class="token comment">//---------------</span><br>         <br>        <span class="token comment">//for each row in sheet</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>headersAtRow <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lastRow<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span>       <br>          <span class="token comment">//beginning each line ---- MESSAGE ---</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;tr>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token operator">||</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"numbered"</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;li>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>          <span class="token comment">//for each columnsToSend</span><br>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>  <span class="token punctuation">{</span><br>            <span class="token comment">//Write values ---- MESSAGE ---</span><br>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"lines"</span><span class="token punctuation">)</span> <span class="token operator">||</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token operator">||</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"numbered"</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>              message <span class="token operator">=</span> message <br>                <span class="token operator">+</span> <span class="token punctuation">(</span>j <span class="token operator">></span> <span class="token number">0</span><span class="token operator">?</span><span class="token string">"&lt;br />"</span><span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">)</span><br>                <span class="token operator">+</span> <span class="token string">"&lt;b>"</span> <span class="token operator">+</span> values<span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>headersAtRow<span class="token punctuation">]</span><span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><br>                <span class="token operator">+</span> <span class="token string">":&lt;/b> "</span> <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>              message <span class="token operator">=</span> message <br>                <span class="token operator">+</span> <span class="token string">"&lt;td>"</span> <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>columnsToSend<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"&lt;/td>"</span><span class="token punctuation">;</span><br>            <span class="token punctuation">}</span> <br>          <span class="token punctuation">}</span><br>           <br>          <span class="token comment">//ending each line ---- MESSAGE ---</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"lines"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message  <span class="token operator">+</span> <span class="token string">" &lt;hr>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/tr>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"numbered"</span> <span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/li>"</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><br>      <span class="token comment">// END IF HERE</span><br>       <br>      <span class="token comment">//edning Table, List for each sheet ---- MESSAGE ---</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"table"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/table>"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/ul>"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>sheetsToEmail<span class="token punctuation">[</span>h<span class="token punctuation">]</span><span class="token punctuation">.</span>display <span class="token operator">==</span> <span class="token string">"numbered"</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        message <span class="token operator">=</span> message <span class="token operator">+</span> <span class="token string">"&lt;/ol>"</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><br>      <span class="token comment">//message = message  + " &lt;br />";</span><br>    <span class="token punctuation">}</span>    <br>     <br>    <span class="token comment">// footer for message ---- MESSAGE ---</span><br>    message <span class="token operator">=</span> message <span class="token operator">+</span>  <span class="token string">"&lt;br />&lt;br /> "</span> <span class="token operator">+</span> messagePostFix<span class="token punctuation">;</span><br>    <span class="token comment">//write message end ----------------------</span><br>    <br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" Message: "</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">//return false;</span><br>    MailApp<span class="token punctuation">.</span><span class="token function">sendEmail</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>      <span class="token literal-property property">to</span><span class="token operator">:</span> email<span class="token punctuation">,</span><br>      <span class="token literal-property property">subject</span><span class="token operator">:</span> messageSubject<span class="token punctuation">,</span><br>      <span class="token literal-property property">htmlBody</span><span class="token operator">:</span> message<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>         <br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <br>  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>    <br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - emailSheetContent ENDED"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - emailSheetContent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>The following variables must be defined</p>
<pre class="language-js"><code class="language-js"><span class="token comment">/**<br> * @param {string} emailOptionsSheet the sheet name for the Email Options. Default is "Email Options"<br> * @param {boolean} enableStackdriverLogging True to enable Stackdriver Logging. Default is false<br> * @param {string} logingName logging name to be appended in the message. Default is ""<br> * @return {number} Not applicable.<br> */</span></code></pre>
<p>Links to a sample spreadsheet</p>
<ul>
<li><a href="https://drive.google.com/open?id=1_DcS39gq0B8T_Hn3lx8qPi1Ym4bqYt-Nhrbv84aApI8" target="_blank">View</a></li>
<li><a href="https://docs.google.com/spreadsheets/d/1_DcS39gq0B8T_Hn3lx8qPi1Ym4bqYt-Nhrbv84aApI8/copy" target="_blank">Copy</a></li>
</ul>

                </div>
            </div>
        </main>
        <!-- Footer -->
            <footer class="govcy-container-fluid govcy-p-3 govcy-pl-0 govcy-d-print-none">
        <div class="govcy-container">
            <div class="row">   
                <div class="govcy-footer">
                        <ul class="govcy-d-inline-block govcy-m-0  govcy-pl-0 govcy-efs-medium">
                            <li><a href="/privacy-statement/">Privacy</a></li>
                            <li><a href="/cookie-policy/">Cookies</a></li>
                            <li><a href="/accessibility-statement/">Accessibility</a></li>
                            <li class="govcy-d-block govcy-text-dark">© Constantinos Evangelou, 2024</li>
                        </ul>
                </div>
            </div>
        </div>
    </footer>
        <!-- js stuff -->
                <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
        
        </script>       
    </body>
</html>