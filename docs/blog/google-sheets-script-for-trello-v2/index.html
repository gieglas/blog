<!doctype html>
<html lang="en">
    <head>
    <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Social -->
        <meta property="og:description" content="Since I have posted the Google Sheets script for Trello I made some updates to include members assigned to card and customfields value (power-up), so I thought I’d share the code.">
        <meta property="og:title" content="Google Sheets script for Trello V2 - Con&#39;s place">
        <meta property="og:url" content="https://gieglas.github.io/blog/">
        <meta property="og:type" content="website">
        <meta property="og:image" content="/blog/img/Screen-Shot-08-23-18-at-10.13-AM.jpg">
        <meta property="og:site_name" content="Con&#39;s place">
    
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://gieglas.github.io/blog/">
        <meta property="twitter:title" content="Google Sheets script for Trello V2 - Con&#39;s place">
        <meta property="twitter:description" content="Since I have posted the Google Sheets script for Trello I made some updates to include members assigned to card and customfields value (power-up), so I thought I’d share the code.">
        <meta property="twitter:image" content="/blog/img/Screen-Shot-08-23-18-at-10.13-AM.jpg">
        <!-- Theme --> 
        <link rel="manifest" href="/blog/manifest.json">
        <meta name="theme-color" content="#0090d3">
        <link rel="icon" type="image/png" sizes="48x48" href="/blog/img/favicon-48x48.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/blog/img/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/blog/img/favicon-16x16.png">
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/img/apple-touch-icon-144x144-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/blog/img/apple-touch-icon-120x120-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/blog/img/apple-touch-icon-114x114-precomposed.png">
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/blog/img/apple-touch-icon-72x72-precomposed.png">
        <link rel="apple-touch-icon-precomposed" href="/blog/img/apple-touch-icon-57x57-precomposed.png">
        <!-- Bootstrap CSS -->
        <link href="/blog/css/main.css" rel="stylesheet" >
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-theme-classic"/>
        <link href="/blog/css/docs.css" rel="stylesheet" >
        <!-- Prism Highlighter CSS -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css" rel="stylesheet">
        <title>Google Sheets script for Trello V2 - Con&#39;s place</title>
        <meta name="description" content="Since I have posted the Google Sheets script for Trello I made some updates to include members assigned to card and customfields value (power-up), so I thought I’d share the code.">
        <meta name="author" content="Constantinos Evangelou">
    </head>
    <body>
        <!-- Skip link -->
        <a href="#mainContainer" class="govcy-skip-link govcy-mb-0">Skip to main content</a> 
        <!--Header-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Shadows+Into+Light+Two&display=swap" rel="stylesheet">
    <header class="govcy-container-fluid govcy-p-0 govcy-pt-2 govcy-m-0 govcy-position-relative govcy-d-print-none ce-header">
         <div class="govcy-container">
             <div class="row">
                <!--Displayed only on desktop-->
                <div class="d-none d-md-block govcy-p-0 govcy-m-0 ">
                    <a href="/blog/" class="desktop-header personal-logo">
                        <img aria-hidden="true" alt="Con&#39;s place logo" src="/blog/img/GieglasIconInverse.png">
                        Con&#39;s place
                    </a>
                </div>
                <!-- Diplay only on desktop end -->
                <span class="d-none d-md-block tagline govcy-mb-0 govcy-mt-1 govcy-ml-1">Be creative </span>
                <div class="govcy-header govcy-mb-0">
                    <nav class="navbar navbar-expand-md navbar-light">
                        <div class="govcy-container govcy-p-0 govcy-m-0 govcy-mr-2">
                            <!--Displayed only on mobile-->
                            <div class="d-md-none"><a href="/blog/" class="mobile-header personal-logo"><img alt="Con&#39;s place" src="/blog/img/GieglasIconInverse.png">Con&#39;s place</a></div>
                            <!-- Displayed only on mobile end -->
                            <!-- Displayed only on mobile button-->                            
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                <span>
                                    <span style="vertical-align: middle !important;" class="govcy-mr-1 material-icons">menu</span>Menu 
                                </span>
                            </button>
                            <!-- Displayed only on mobile end -->
                            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                                <ul class="navbar-nav me-auto mb-2 mb-md-0 govcy-ml-3">
                                    <li class="nav-item">
                                    <a href="/blog/"  class="nav-link" >
                                        Home
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/blog/"  class="nav-link active" aria-current="page" >
                                        Blog
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/about/"  class="nav-link" >
                                        About
                                    </a>
                                    </li><li class="nav-item">
                                    <a href="/blog/search/"  class="nav-link" >
                                        Search
                                    </a>
                                    </li></ul>
                                
                                
                                
                                
                            </div>
                        </div>
                    </nav>
                    <!--Displayed only on mobile-->
                    <span class="d-md-none tagline govcy-mb-0 govcy-ml-3">Be creative </span>
                    <!-- Displayed only on mobile  end -->
                </div>
             </div>
         </div>
    </header>
    
        <!--Main-->
        <main class="govcy-container govcy-my-4" id="mainContainer">
            <div class="row">
                <div class="govcy-col-8 govcy-order-last">
                    <h1>Google Sheets script for Trello V2</h1>
                    <p class="post-date">Posted on 
                                      <time datetime="2019-07-16T00:00:00.000Z">16 July 2019</time> 
                                      • Tagged with 
                                      
                                            <a class="post-tag" href="/blog/tags/google-sheets">google-sheets</a>
                                        
                                            <a class="post-tag" href="/blog/tags/trello">trello</a>
                                        
                                            <a class="post-tag" href="/blog/tags/dev">dev</a>
                                        
                                            <a class="post-tag" href="/blog/tags/productivity">productivity</a>
                                        </p>
                    
                     
                    <img aria-hidden="true" src="/blog/img/Screen-Shot-08-23-18-at-10.13-AM.jpg" alt="Graphic for Google Sheets script for Trello V2" class="img-fluid pop-small govcy-mb-4"></a>
                    
                    <div class="blog-page">
                    <p>Since I have posted the <a href="../google-sheets-script-for-trello/">Google Sheets script for Trello</a> I made some updates to include members assigned to card and customfields value (power-up), so I thought I’d share the code.</p>
<pre class="language-js"><code class="language-js"><span class="token comment">/**<br> * Loads the details from a Trello board using the Trello API v1, into a google sheet.<br> *<br> * Each time it is run the sheet gets cleared and the following data are downloaded from the Trello board <br> *"Date", "Task", "Desc", "Who", "List", "Link", "Labels","Label Colors","Checklists", "Due Date", "Due Complete","Task (Link)", "Members", "Comments"<br> *<br> * NOTE: Additional columns are created for custom fields if any<br> *<br> * Additionally the sheet for checklist gets cleared and the following data are downloaded from the Trello board <br> *"Card","Checklist", "Check Name", "State","Task","Who","Link","Labels","Due Date","Due Complete","List","Members"<br> * <br> * Additionally the sheet for comments gets cleared and the following data are downloaded from the Trello board <br> *"Card","Date", "Who Commented", "Comment","Task","Who","Link","Labels","Due Date","Due Complete","List","Members"<br> *<br> * @param {string} api_key The Trello API Key (Get it from https://trello.com/app-key)<br> * @param {string} api_token The Trello API token (Get it from https://trello.com/app-key)<br> * @param {string} board_id The Trello Board ID who's cards will be downloaded (Get it from adding ".json" at the end of the board url)<br> * @param {string} sheetName The name of the sheet in the active spreadsheet to update it's rows<br> * @param {string} checklistSheetName The name of the sheet in the active spreadsheet to update it's rows for checklists<br> * @param {string} commentsSheetName The name of the sheet in the active spreadsheet to update it's rows for comments<br> * @param {boolean} enableStackdriverLogging True to enable Stackdriver Logging. Default is false<br> * @param {string} logingName logging name to be appended in the message. Default is ""<br> * @return {void} Not applicable. <br> */</span><br><span class="token keyword">function</span> <span class="token function">loadTrello</span><span class="token punctuation">(</span><span class="token parameter">api_key<span class="token punctuation">,</span>api_token<span class="token punctuation">,</span>board_id<span class="token punctuation">,</span>sheetName<span class="token punctuation">,</span>checklistSheetName<span class="token punctuation">,</span> commentsSheetName<span class="token punctuation">,</span> enableStackdriverLogging<span class="token punctuation">,</span> logingName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">try</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">time</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - loadTrello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - Loading from Trello STARTED"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token keyword">var</span> url <span class="token operator">=</span> <span class="token string">"https://api.trello.com/1/"</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> key_and_token <span class="token operator">=</span> <span class="token string">"key="</span><span class="token operator">+</span>api_key<span class="token operator">+</span><span class="token string">"&amp;token="</span><span class="token operator">+</span>api_token<span class="token punctuation">;</span>    <br>    <span class="token keyword">var</span> cr <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">// get sheet with name Trello, clear all contents, add titles</span><br>    <span class="token keyword">var</span> ss <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> trelloFiledHeaders <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Date"</span><span class="token punctuation">,</span> <span class="token string">"Task"</span><span class="token punctuation">,</span> <span class="token string">"Desc"</span><span class="token punctuation">,</span> <span class="token string">"Who"</span><span class="token punctuation">,</span> <span class="token string">"List"</span><span class="token punctuation">,</span> <span class="token string">"Link"</span><span class="token punctuation">,</span> <span class="token string">"Labels"</span><span class="token punctuation">,</span><span class="token string">"Label Colors"</span><span class="token punctuation">,</span><span class="token string">"Checklists"</span><span class="token punctuation">,</span> <span class="token string">"Due Date"</span><span class="token punctuation">,</span> <span class="token string">"Due Complete"</span><span class="token punctuation">,</span> <span class="token string">"Task (Link1)"</span><span class="token punctuation">,</span> <span class="token string">"Members"</span><span class="token punctuation">,</span> <span class="token string">"Comments"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>    <span class="token comment">// headers without custom fields</span><br>    <span class="token keyword">var</span> originalTrelloFiledHeadersCount <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span><br>    <span class="token comment">// headers with custom fields</span><br>    <span class="token keyword">var</span> trelloFiledHeadersCount <span class="token operator">=</span> originalTrelloFiledHeadersCount<span class="token punctuation">;</span><br>    <span class="token comment">//Get all custom fields from Trello API</span><br>    <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"boards/"</span> <span class="token operator">+</span> board_id <span class="token operator">+</span> <span class="token string">"/customFields?"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> boardCustomFields <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token comment">// for all custom fields</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> boardCustomFields<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      trelloFiledHeaders<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>boardCustomFields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token comment">//position in append array of custom fields</span><br>      boardCustomFields<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>pos<span class="token operator">=</span>trelloFiledHeadersCount<span class="token punctuation">;</span><br>      trelloFiledHeadersCount<span class="token operator">++</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>    ss<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span>trelloFiledHeaders<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    ss<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>trelloFiledHeadersCount<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFontWeight</span><span class="token punctuation">(</span><span class="token string">"Bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">// get sheet for checklists, clear all contents, add titles</span><br>    <span class="token keyword">var</span> ssChecklist <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>checklistSheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    ssChecklist<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Card"</span><span class="token punctuation">,</span><span class="token string">"Checklist"</span><span class="token punctuation">,</span> <span class="token string">"Check Name"</span><span class="token punctuation">,</span> <span class="token string">"State"</span><span class="token punctuation">,</span><span class="token string">"Task"</span><span class="token punctuation">,</span><span class="token string">"Who"</span><span class="token punctuation">,</span><span class="token string">"Link"</span><span class="token punctuation">,</span><span class="token string">"Labels"</span><span class="token punctuation">,</span><span class="token string">"Due Date"</span><span class="token punctuation">,</span><span class="token string">"Due Complete"</span><span class="token punctuation">,</span><span class="token string">"List"</span><span class="token punctuation">,</span><span class="token string">"Members"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    ssChecklist<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFontWeight</span><span class="token punctuation">(</span><span class="token string">"Bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">// get sheet for comments, clear all contents, add titles</span><br>    <span class="token keyword">var</span> ssComments <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActive</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>commentsSheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    ssComments<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"Card"</span><span class="token punctuation">,</span><span class="token string">"Date"</span><span class="token punctuation">,</span> <span class="token string">"Who Commented"</span><span class="token punctuation">,</span> <span class="token string">"Comment"</span><span class="token punctuation">,</span><span class="token string">"Task"</span><span class="token punctuation">,</span><span class="token string">"Who"</span><span class="token punctuation">,</span><span class="token string">"Link"</span><span class="token punctuation">,</span><span class="token string">"Labels"</span><span class="token punctuation">,</span><span class="token string">"Due Date"</span><span class="token punctuation">,</span><span class="token string">"Due Complete"</span><span class="token punctuation">,</span><span class="token string">"List"</span><span class="token punctuation">,</span><span class="token string">"Members"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    ssComments<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFontWeight</span><span class="token punctuation">(</span><span class="token string">"Bold"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">//Get all lists from Trello API</span><br>    <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"boards/"</span> <span class="token operator">+</span> board_id <span class="token operator">+</span> <span class="token string">"/lists?cards=all&amp;"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">var</span> lists <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>     <br>    <span class="token comment">// for all lists </span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lists<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">var</span> list <span class="token operator">=</span> lists<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>      <span class="token comment">// Get all cards from Trello API</span><br>      <span class="token comment">// /?filter=all if we want archived as well (archived have closed:true)</span><br>      <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"list/"</span> <span class="token operator">+</span> list<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"/cards/?actions=all&amp;customFieldItems=true&amp;"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span> <br>      <span class="token keyword">var</span> cards <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>cards<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span><br>       <br>      <span class="token comment">// for all cards</span><br>      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cards<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">var</span> appentArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>trelloFiledHeadersCount<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">//initialize custom fields values</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> jk<span class="token operator">=</span>originalTrelloFiledHeadersCount<span class="token punctuation">;</span> jk <span class="token operator">&lt;</span> trelloFiledHeadersCount<span class="token punctuation">;</span> jk<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          appentArray<span class="token punctuation">[</span>jk<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">var</span> card <span class="token operator">=</span> cards<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span><br>         <br>        <span class="token keyword">var</span> name <span class="token operator">=</span> card<span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> link <span class="token operator">=</span> card<span class="token punctuation">.</span>shortUrl<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> listname <span class="token operator">=</span> list<span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> desc <span class="token operator">=</span> card<span class="token punctuation">.</span>desc<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> duedate <span class="token operator">=</span> card<span class="token punctuation">.</span>due<span class="token punctuation">;</span><br>        <span class="token keyword">var</span> duecomplete <span class="token operator">=</span> <span class="token punctuation">(</span>card<span class="token punctuation">.</span>dueComplete <span class="token operator">==</span> <span class="token boolean">true</span> <span class="token operator">?</span> <span class="token string">'YES'</span> <span class="token operator">:</span> <span class="token string">'NO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> labels <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> labelsColors <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> l<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> card<span class="token punctuation">.</span>labels<span class="token punctuation">.</span>length<span class="token punctuation">;</span> l<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          labels <span class="token operator">=</span> labels <span class="token operator">+</span> <span class="token punctuation">(</span>labels <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">", "</span><span class="token punctuation">)</span>  <span class="token operator">+</span> card<span class="token punctuation">.</span>labels<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>          labelsColors <span class="token operator">=</span> labelsColors <span class="token operator">+</span> <span class="token punctuation">(</span>labelsColors <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>  <span class="token operator">+</span> card<span class="token punctuation">.</span>labels<span class="token punctuation">[</span>l<span class="token punctuation">]</span><span class="token punctuation">.</span>color<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token keyword">var</span> namelink <span class="token operator">=</span> <span class="token string">'=HYPERLINK("'</span> <span class="token operator">+</span> link <span class="token operator">+</span><span class="token string">'", "'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'")'</span><span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k <span class="token operator">&lt;</span> card<span class="token punctuation">.</span>actions<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token comment">// Get the rest of the card data</span><br>          <span class="token keyword">var</span> dato <span class="token operator">=</span> card<span class="token punctuation">.</span>actions<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">;</span><br>          <span class="token keyword">var</span> fullname <span class="token operator">=</span> card<span class="token punctuation">.</span>actions<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">.</span>memberCreator<span class="token punctuation">.</span>fullName<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>         <br>        <span class="token comment">// ------- Custom Fields  --------------------</span><br>        <span class="token keyword">var</span> customFieldItems <span class="token operator">=</span> card<span class="token punctuation">.</span>customFieldItems<span class="token punctuation">;</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> ck<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> ck <span class="token operator">&lt;</span> customFieldItems<span class="token punctuation">.</span>length<span class="token punctuation">;</span> ck<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          <span class="token comment">// get board custom field from id</span><br>          <span class="token keyword">var</span> boardCustomField <span class="token operator">=</span> <span class="token function">searchArray</span><span class="token punctuation">(</span>customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>idCustomField<span class="token punctuation">,</span> boardCustomFields<span class="token punctuation">)</span><span class="token punctuation">;</span><br>           <br>          <span class="token keyword">var</span> customFieldValueText <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>          <span class="token keyword">if</span> <span class="token punctuation">(</span>boardCustomField<span class="token punctuation">.</span>type<span class="token operator">==</span><span class="token string">"text"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            customFieldValueText <span class="token operator">=</span> customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>text<span class="token punctuation">;</span><br>          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>boardCustomField<span class="token punctuation">.</span>type<span class="token operator">==</span><span class="token string">"checkbox"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            customFieldValueText <span class="token operator">=</span> customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>checked<span class="token punctuation">;</span> <br>          <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>boardCustomField<span class="token punctuation">.</span>type<span class="token operator">==</span><span class="token string">"date"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            customFieldValueText <span class="token operator">=</span> customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>date<span class="token punctuation">;</span> <br>          <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>boardCustomField<span class="token punctuation">.</span>type<span class="token operator">==</span><span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            customFieldValueText <span class="token operator">=</span> customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>number<span class="token punctuation">;</span> <br>          <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>boardCustomField<span class="token punctuation">.</span>type<span class="token operator">==</span><span class="token string">"list"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            customFieldValueText <span class="token operator">=</span> <span class="token function">searchArray</span><span class="token punctuation">(</span>customFieldItems<span class="token punctuation">[</span>ck<span class="token punctuation">]</span><span class="token punctuation">.</span>idValue<span class="token punctuation">,</span> boardCustomField<span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span>text<span class="token punctuation">;</span> <br>          <span class="token punctuation">}</span><br>            appentArray<span class="token punctuation">[</span>boardCustomField<span class="token punctuation">.</span>pos<span class="token punctuation">]</span> <span class="token operator">=</span> customFieldValueText<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>        <span class="token comment">// Get custom field items END -----</span><br>                <br>        <span class="token comment">//-------- Members  ----------------------</span><br>        <span class="token comment">//Get all Members frin API</span><br>        <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"cards/"</span> <span class="token operator">+</span> card<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"/members/?"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> membersdetails <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>                 <br>        <span class="token keyword">var</span> membersstr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>         <br>        <span class="token comment">// For all checklists get Name</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> o<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> o <span class="token operator">&lt;</span> membersdetails<span class="token punctuation">.</span>length<span class="token punctuation">;</span> o<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          membersstr <span class="token operator">=</span> membersstr <span class="token operator">+</span> <span class="token punctuation">(</span>membersstr <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">", \n"</span><span class="token punctuation">)</span> <span class="token operator">+</span> membersdetails<span class="token punctuation">[</span>o<span class="token punctuation">]</span><span class="token punctuation">.</span>fullName<span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>         <br>        <span class="token comment">//-------- Checklists ----------------------</span><br>        <span class="token comment">//Get all checklists of card from Trello API</span><br>        <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"cards/"</span> <span class="token operator">+</span> card<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"/checklists?action=all&amp;"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> cardchecklists <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>         <br>        <span class="token keyword">var</span> checkliststr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>        <span class="token comment">// For all checklists get Name</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> m<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> m <span class="token operator">&lt;</span> cardchecklists<span class="token punctuation">.</span>length<span class="token punctuation">;</span> m<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          checkliststr <span class="token operator">=</span> checkliststr <span class="token operator">+</span> <span class="token punctuation">(</span>checkliststr <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span> <span class="token operator">+</span> cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">+</span> <span class="token string">"\n --------- \n"</span><span class="token punctuation">;</span><br>          <span class="token comment">// For all checklists get Items</span><br>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            checkliststr <span class="token operator">=</span> checkliststr <span class="token operator">+</span> <span class="token punctuation">(</span>checkliststr <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"\n"</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>state <span class="token operator">==</span> <span class="token string">'complete'</span> <span class="token operator">?</span> <span class="token string">"[x] "</span><span class="token operator">:</span><span class="token string">"[ ] "</span> <span class="token punctuation">)</span> <span class="token operator">+</span> cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span><br>            <span class="token comment">//append row in checklist sheet            </span><br>            ssChecklist<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span>card<span class="token punctuation">.</span>name<span class="token punctuation">,</span>cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>state<br>              <span class="token punctuation">,</span>name <span class="token operator">+</span> <span class="token string">" - "</span> <span class="token operator">+</span>cardchecklists<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">.</span>checkItems<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span>fullname<span class="token punctuation">,</span>link<span class="token punctuation">,</span>labels<span class="token punctuation">,</span>duedate<span class="token punctuation">,</span>duecomplete<span class="token punctuation">,</span>listname<span class="token punctuation">,</span>membersstr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>          <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>         <br>        <span class="token comment">//-------- Comments ----------------------</span><br>        <span class="token comment">//Get all comments of card from Trello API</span><br>        <span class="token keyword">var</span> response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url <span class="token operator">+</span> <span class="token string">"cards/"</span> <span class="token operator">+</span> card<span class="token punctuation">.</span>id <span class="token operator">+</span> <span class="token string">"/?actions=commentCard&amp;"</span> <span class="token operator">+</span> key_and_token<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">var</span> cardcomments <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>actions<span class="token punctuation">;</span><br>         <br>        <span class="token keyword">var</span> cardcommentsstr <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span><br>        <span class="token comment">// For all comments get Name</span><br>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> p<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> cardcomments<span class="token punctuation">.</span>length<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          cardcommentsstr <span class="token operator">=</span> cardcommentsstr <span class="token operator">+</span> <span class="token punctuation">(</span>cardcommentsstr <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">?</span> <span class="token string">""</span> <span class="token operator">:</span> <span class="token string">"\n\n"</span><span class="token punctuation">)</span> <span class="token operator">+</span> cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>date <span class="token operator">+</span> <span class="token string">" --"</span> <span class="token operator">+</span> cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>memberCreator<span class="token punctuation">.</span>fullName <span class="token operator">+</span> <span class="token string">"\n --------- \n"</span> <span class="token operator">+</span> cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>text<span class="token punctuation">;</span><br>          <span class="token comment">//append row in checklist sheet            </span><br>            ssComments<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span>card<span class="token punctuation">.</span>name<span class="token punctuation">,</span>cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>date<span class="token punctuation">,</span> cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>memberCreator<span class="token punctuation">.</span>fullName<span class="token punctuation">,</span> cardcomments<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>text<br>              <span class="token punctuation">,</span>name<span class="token punctuation">,</span>fullname<span class="token punctuation">,</span>link<span class="token punctuation">,</span>labels<span class="token punctuation">,</span>duedate<span class="token punctuation">,</span>duecomplete<span class="token punctuation">,</span>listname<span class="token punctuation">,</span>membersstr<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <br>        <span class="token punctuation">}</span><br>               <br>      <span class="token comment">//Append row with data</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> dato<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span>  name<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span>  desc<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span>  fullname<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span>  listname<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span>  link<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span>  labels<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span>  labelsColors<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span>  checkliststr<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span>  duedate<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span>  duecomplete<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span>  namelink<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span>  membersstr<span class="token punctuation">;</span><br>      appentArray<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span>  cardcommentsstr<span class="token punctuation">;</span><br>      ss<span class="token punctuation">.</span><span class="token function">appendRow</span><span class="token punctuation">(</span>appentArray<span class="token punctuation">)</span><span class="token punctuation">;</span><br>       <br>      <span class="token comment">//change labels color ---</span><br>      <span class="token keyword">var</span> labelsColor <span class="token operator">=</span> labelsColors<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">if</span> <span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"sky"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        ss<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>cr<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span><span class="token string">"#87CEFA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        ss<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>cr<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setBackground</span><span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"red"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"black"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"purple"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"green"</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>labelsColor<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"blue"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>          ss<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>cr<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFontColor</span><span class="token punctuation">(</span><span class="token string">"white"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>      <span class="token punctuation">}</span><br>      <span class="token comment">//change labels color END ---</span><br>       <br>      cr<span class="token operator">++</span><span class="token punctuation">;</span><br>     <span class="token punctuation">}</span>                                      <br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" ERROR: "</span> <span class="token operator">+</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <br>  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - Loading from Trello ENDED"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>enableStackdriverLogging<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">timeEnd</span><span class="token punctuation">(</span>logingName <span class="token operator">+</span> <span class="token string">" - loadTrello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span><br> <br><span class="token comment">/**<br>* Finds objects in an array of objects by obj.id <br>*<br>* @param {string} idKey The id sting to find<br>* @param {Array} myArray The array that contains the objects<br>* @return {object} The object that is found. <br>*/</span><br><span class="token keyword">function</span> <span class="token function">searchArray</span><span class="token punctuation">(</span><span class="token parameter">idKey<span class="token punctuation">,</span> myArray</span><span class="token punctuation">)</span><span class="token punctuation">{</span><br>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> myArray<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">if</span> <span class="token punctuation">(</span>myArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>id <span class="token operator">===</span> idKey<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">return</span> myArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>

                    </div>
                </div>
            </div>
        </main>
        <!-- Footer -->
            <footer class="govcy-container-fluid govcy-p-3 govcy-pl-0 govcy-d-print-none">
        <div class="govcy-container">
            <div class="row">   
                <div class="govcy-footer">
                        <ul class="govcy-d-inline-block govcy-m-0  govcy-pl-0 govcy-efs-medium">
                            <li><a href="/blog/privacy-statement/">Privacy</a></li>
                            <li><a href="/blog/cookie-policy/">Cookies</a></li>
                            <li><a href="/blog/accessibility/">Accessibility</a></li>
                            <li class="govcy-d-block govcy-text-dark">© Constantinos Evangelou, 2024</li>
                        </ul>
                </div>
            </div>
        </div>
    </footer>
        <!-- js stuff -->
                <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
        
        </script>       
    </body>
</html>